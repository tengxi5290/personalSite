webpackJsonp([13],{gfDe:function(e,t,a){var s=a("u2LI");"string"==typeof s&&(s=[[e.i,s,""]]),s.locals&&(e.exports=s.locals);a("rjj0")("a2b025f0",s,!0,{})},oLXO:function(e,t,a){"use strict";function s(e){a("gfDe")}Object.defineProperty(t,"__esModule",{value:!0});var i=a("lcoF"),n=a("5HJ5"),o=a("mtWM"),r=a.n(o),l=a("nSkA"),d=a("x1ym"),c={mixins:[n.a,i.a],data:function(){var e=d.a.required("此项必填");d.a.number("只能输入数字");return{userType:null,showPicture:!0,currentSite:null,showImage:!0,params:{querySiteId:"",pageNo:"",pageSize:"",root:""},ftpList:[],ossList:[],tplList:[],editTable:!1,dateList:!0,domainCheck:!1,accessPathCheck:!1,siteIdCheckRes:!1,rules:{name:[e],shortName:[e],domain:[e],rootPath:[e],enable:[e],logo:[e]}}},methods:{back:function(){var e=this;setTimeout(function(){e.editTable=!1,e.dateList=!0},1e3)},reset:function(){var e=this;this.dataInfo.name="",this.dataInfo.shortName="",this.dataInfo.domain="",this.dataInfo.enable=!0,this.dataInfo.logo="",this.showImage=!1,setTimeout(function(){e.showImage=!0},100)},getUrl:function(e){this.dataInfo.logo=e},getFieldImg:function(e,t){this.dataInfo.logo=e,this.showPicture=!1},remove:function(e,t){"remove"==e&&delete this.dataInfo.logo},deleteDefault:function(e){this.showPicture=!1},siteIdCheck:function(e){var t=this;if(!e)return this.siteIdCheckRes=!1,!1;r.a.post(this.$api.siteCheckMaster,{siteId:this.params.querySiteId,accessPath:this.dataInfo.accessPath}).then(function(e){e.body.result||(t.siteIdCheckRes=!0,t.loading=!1)}).catch(function(e){t.loading=!1})},checkDomain:function(e){var t=this;if(""==e)return this.domainCheck=!1,!1;r.a.post(this.$api.siteCheckDomain,{siteId:this.params.querySiteId,domain:e}).then(function(e){t.loading=!1,e.body.result?t.domainCheck=!1:t.domainCheck=!0}).catch(function(e){t.loading=!1})},checkAccessPath:function(e){var t=this;if(""==e)return this.accessPathCheck=!1,!1;r.a.post(this.$api.siteCheckAccessPath,{siteId:this.params.querySiteId,accessPath:e}).then(function(e){e.body.result?(t.accessPathCheck=!1,t.loading=!1):(t.accessPathCheck=!0,t.loading=!1)}).catch(function(e){t.loading=!1})},update:function(){var e=this;if(!(this.domainCheck||this.accessPathCheck||this.siteIdCheckRes)){var t=this.currentSite;l.a.put(this.$api.site+"/"+t,{name:this.dataInfo.name,shortName:this.dataInfo.shortName,rootPath:this.dataInfo.rootPath,domin:this.dataInfo.domin,enable:this.dataInfo.enable,logo:this.dataInfo.logo}).then(function(t){"0"==t.data.errorCode?(e.successMessage("操作成功"),e.editTable=!1,e.dateList=!0):t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("操作失败")}).catch(function(e){console.log(e)})}},edit:function(e){var t=this;this.currentSite=e,l.a.get(this.$api.site+"/"+e).then(function(e){"0"==e.data.errorCode?(t.editTable=!0,t.dateList=!1,t.dataInfo=e.data.data):e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("请求失败")}).catch(function(e){console.log(e)})},getTableData:function(e){this.loading=!0,this.tableData=e,this.loading=!1},nodeClik:function(e){var t=this;if(this.currentSite=e.id,this.params.querySiteId=e.id,e.hasChild||""==e.id){if(""==e.id)return;this.editTable=!1,this.dateList=!0}else{var a=this.$api.site,s=e.id;this.editTable=!1,l.a.get(a+"/"+s).then(function(e){"0"==e.data.errorCode?(t.dataInfo=e.data.data,t.editTable=!0,t.dateList=!1):e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("请求失败")}).catch(function(e){console.log(e)})}},getUserInfo:function(){var e=this;l.a.get(this.$api.siteList).then(function(t){"0"==t.data.errorCode?(Object(l.c)(t),e.loading=!1,l.a.get(e.$api.siteList).then(function(t){if("0"==t.data.errorCode){var a=t.data.data;e.getTableData(a)}else t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("请求失败")}).catch(function(e){console.log(e)})):t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("请求失败")}).catch(function(e){console.log(e)})}},created:function(){this.loading=!0,this.getUserInfo(),this.userType=window.localStorage.getItem("userType"),this.$store.dispatch("setCollapse",!0)},mounted:function(){var e=document.body.clientHeight;$(".cms-body").css("minHeight",e-110+"px")}},h=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"cms-body"},[a("section",{staticClass:"tree-left"},[a("cmsSiteTree",{on:{"node-click":e.nodeClik}})],1),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:e.dateList,expression:"dateList"},{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"tree-right"},[a("div",{staticClass:"cms-list-header"},[a("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/site/add",expression:"'/site/add'"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.routerLink("/site/add","save","0")}}},[e._v("添加")])],1),e._v(" "),a("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,stripe:""},on:{"selection-change":e.checkIds}},[a("el-table-column",{attrs:{type:"selection",width:"65",align:"right"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"ID",width:"50",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"domain",label:"域名",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"站点名称",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("cms-button",{directives:[{name:"perms",rawName:"v-perms",value:"/site/edit",expression:"'/site/edit'"}],attrs:{type:"edit"},nativeOn:{click:function(a){e.edit(t.row.id)}}})],1)}}])})],1)],1),e._v(" "),a("section",{directives:[{name:"show",rawName:"v-show",value:e.editTable,expression:"editTable"}],staticClass:"tree-right"},[a("div",{staticClass:"cms-list-header"},[a("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/site/add",expression:"'/site/add'"}],attrs:{type:"primary",icon:"el-icon-plus"},on:{click:function(t){e.routerLink("/site/add","save","0",{pid:e.dataInfo.id})}}},[e._v("添加")])],1),e._v(" "),a("el-form",{ref:"form",staticClass:"cms-form",attrs:{model:e.dataInfo,rules:e.rules,"label-width":"162px"}},[a("el-form-item",{staticClass:"flex-50",attrs:{label:"名称",prop:"name"}},[a("el-input",{staticClass:"cms-width",model:{value:e.dataInfo.name,callback:function(t){e.$set(e.dataInfo,"name",t)},expression:"dataInfo.name"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"站点简称",prop:"shortName"}},[a("el-input",{staticClass:"cms-width",model:{value:e.dataInfo.shortName,callback:function(t){e.$set(e.dataInfo,"shortName",t)},expression:"dataInfo.shortName"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"域名",prop:"domain"}},[a("el-input",{staticClass:"cms-width",on:{change:e.checkDomain},model:{value:e.dataInfo.domain,callback:function(t){e.$set(e.dataInfo,"domain",t)},expression:"dataInfo.domain"}}),e._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:e.domainCheck,expression:"domainCheck"}],staticClass:"red"},[e._v("域名已存在，无法使用")])],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"根目录",prop:"rootPath"}},[a("el-input",{staticClass:"cms-width",attrs:{disabled:""},model:{value:e.dataInfo.rootPath,callback:function(t){e.$set(e.dataInfo,"rootPath",t)},expression:"dataInfo.rootPath"}}),e._v(" "),a("span",{staticClass:"gray"},[e._v("各站点资源的存放路径")])],1),e._v(" "),a("el-form-item",{staticClass:"flex-100",attrs:{label:"是否可用",prop:"enable"}},["SP_ADMIN"!=e.userType&&"MASTER_ADMIN"!=e.userType?a("el-radio",{attrs:{label:!0},model:{value:e.dataInfo.enable,callback:function(t){e.$set(e.dataInfo,"enable",t)},expression:"dataInfo.enable"}},[e._v("是")]):a("el-radio",{attrs:{label:!0,readonly:""},model:{value:e.dataInfo.enable,callback:function(t){e.$set(e.dataInfo,"enable",t)},expression:"dataInfo.enable"}},[e._v("是")]),e._v(" "),"SP_ADMIN"!=e.userType&&"MASTER_ADMIN"!=e.userType?a("el-radio",{attrs:{label:!1},model:{value:e.dataInfo.enable,callback:function(t){e.$set(e.dataInfo,"enable",t)},expression:"dataInfo.enable"}},[e._v("否")]):a("el-radio",{attrs:{label:!1,readonly:""},model:{value:e.dataInfo.enable,callback:function(t){e.$set(e.dataInfo,"enable",t)},expression:"dataInfo.enable"}},[e._v("否")])],1),e._v(" "),a("el-form-item",{staticClass:"flex-100",attrs:{label:"站点图标",prop:"logo"}},[e.editTable&&e.showImage?a("uploader",{attrs:{default:e.dataInfo.logo},on:{change:e.getUrl}}):e._e()],1),e._v(" "),a("div",{staticClass:"form-footer"},[a("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/site/edit",expression:"'/site/edit'"}],attrs:{type:"primary"},on:{click:function(t){e.update()}}},[e._v("修改")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.reset}},[e._v("重置")]),e._v(" "),a("el-button",{attrs:{type:"warning"},on:{click:e.back}},[e._v("返回")])],1)],1)],1)])},u=[],f={render:h,staticRenderFns:u},m=f,p=a("VU/8"),g=s,b=p(c,m,!1,g,null,null);t.default=b.exports},u2LI:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,"\n.tree-left{\n    width: 200px;\n    float: left;\n}\n.tree-right{\n    margin-left: 200px;\n}\n.font-bold{\n    font-weight: bold;\n}\n.iconfont{\n    color: #409EFF;\n}\n.red-color{\n    color: red;\n}\n  /*显示当前的默认图片*/\n.display-picture {\n    position: relative;\n    overflow: hidden;\n    z-index: 0;\n    width: 100%;\n    background-color: #fff;\n    border: 1px solid #c0ccda;\n    border-radius: 6px;\n    -webkit-box-sizing: border-box;\n    box-sizing: border-box;\n    margin-top: 10px;\n    padding: 10px 10px 10px 90px;\n    height: 92px;\n}\n.display-thumb {\n    vertical-align: middle;\n    display: inline-block;\n    width: 70px;\n    height: 70px;\n    background-color: pink;\n    float: left;\n    position: relative;\n    z-index: 1;\n    margin-left: -80px;\n}\n.display-filename {\n    line-height: 70px;\n    margin-top: 0;\n}\n.delete-default {\n  position: absolute;\n  top: 0;\n  right: 10px;\n  cursor: hand;\n  cursor: pointer;\n}\n",""])}});