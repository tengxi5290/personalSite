webpackJsonp([154],{AZa3:function(e,t,n){var i=n("xMn1");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);n("rjj0")("6e41c831",i,!0,{})},Mbs9:function(e,t,n){"use strict";function i(e){n("AZa3")}Object.defineProperty(t,"__esModule",{value:!0});var a=n("5HJ5"),o=n("lcoF"),s=(n("mtWM"),n("x1ym")),r=n("nSkA"),l={mixins:[a.a,o.a],data:function(){var e=s.a.required("此项必填");s.a.number("只能输入数字");return{currentSyncModel:null,formList:[],rules:{rule:[e],showName:[e]},info:{enable:!1,rule:0,showName:"",method:"",modelField:"",params:"",status:"",syncModelId:null,url:"",uuid:"",weight:"",channelField:"",siteId:null},formValue:{},ue:[],selectedChannel:null,showInputList:!1,finalChannelId:null}},methods:{back:function(){history.go(-1)},getModelItem:function(){var e=this;r.a.get(this.$api.itemGet+"/"+this.currentSyncModel).then(function(t){if(e.loading=!1,"0"==t.data.errorCode){e.formList=e.resort(t.data.data).reverse();for(var n in e.formList)e.$set(e.formValue,e.formList[n].field),e.formValue[e.formList[n].field]=e.formList[n].field}else t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("操作失败")}).catch(function(t){e.loading=!1,console.log(t)})},resort:function(e){for(var t=0;t<e.length-1;t++)for(var n=0;n<e.length-1-t;n++)if(e[n].priority>e[n+1].priority){var i=e[n];e[n]=e[n+1],e[n+1]=i}return e},getUrl:function(e,t,n,i){this.formValue[t]=e,this.storageId=i,this.poster=n},getUeditor:function(e,t){this.ue[t]=e},getDocTxt:function(e,t){this.ue[t].execCommand("inserthtml",e)},getEditorContent:function(e){this.formValue[e]=this.ue[e].getContent()},getParams:function(){var e={},t=[];for(var n in this.formValue)e.attrObj={},void 0!=this.formValue[n]&&(e.attrObj.contentAttrName=n,this.formValue[n]instanceof Array?e.attrObj.syncAttrName=this.formValue[n].join(","):e.attrObj.syncAttrName=this.formValue[n],t.push(e.attrObj),e.cmsSyncContentAttr=t);return delete e.attrObj,e.enable=this.info.enable,e.channelId=this.finalChannelId,e.method=this.info.method,e.params=this.info.params,e.showName=this.info.showName,e.status=this.info.status,e.rule=this.info.rule,e.modelId=parseInt(this.currentSyncModel),e.url=this.info.url,e.uuid=this.info.uuid,e.weight=this.info.weight.toString(),e.channelField=this.info.channelField,e},reset:function(){this.resetDataInfo(this.formValue)},add:function(){var e=this.getParams();console.log("提交参数"),console.log(e),null==this.info.showName||""==this.info.showName||void 0==this.info.showName?this.errorMessage("请补全接口名称"):this.saves(e)},saves:function(e){var t=this,n=this.$api.syncApi;r.a.post(n,e).then(function(e){"0"==e.data.errorCode?(t.successMessage("添加成功"),setTimeout(function(){t.routerLink("/sync/api")},1e3)):e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("操作失败")})},toggleShow:function(){0==this.showInputList?this.showInputList=!0:this.showInputList=!1},getCurrentChannel:function(e,t){void 0!=t.parent.data&&(this.selectedChannel=e.name,void 0!=t.parent.parent.data&&(this.selectedChannel=t.parent.data.name+"/"+e.name,void 0!=t.parent.parent.parent.data&&(this.selectedChannel=t.parent.parent.data.name+"/"+t.parent.data.name+"/"+e.name))),this.finalChannelId=e.id,this.showInputList=!1}},created:function(){this.currentSyncModel=this.$route.query.id,this.info.syncModelId=this.$route.query.id,this.currentModel=this.$route.query.modelId,this.getModelItem(),this.$store.dispatch("setCollapse",!0)}},d=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("section",{staticClass:"cms-body flex"},[n("a",{staticClass:"cms-back",attrs:{href:"javascript:void(0)"},on:{click:e.back}}),e._v(" "),n("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",staticClass:"cms-form",attrs:{model:e.info,rules:e.rules,"label-width":"162px"}},[n("el-form-item",{staticClass:"flex-50",attrs:{label:"可用",prop:"enable"}},[n("el-radio-group",{model:{value:e.info.enable,callback:function(t){e.$set(e.info,"enable",t)},expression:"info.enable"}},[n("el-radio",{attrs:{label:!0}},[e._v("可用")]),e._v(" "),n("el-radio",{attrs:{label:!1}},[e._v("不可用")])],1)],1),e._v(" "),n("el-form-item",{staticClass:"flex-50",attrs:{label:"匹配方式",prop:"rule"}},[n("el-radio-group",{model:{value:e.info.rule,callback:function(t){e.$set(e.info,"rule",t)},expression:"info.rule"}},[n("el-radio",{attrs:{label:1}},[e._v("主栏目路径")]),e._v(" "),n("el-radio",{attrs:{label:0}},[e._v("全路径")])],1)],1),e._v(" "),n("el-form-item",{staticClass:"flex-50",attrs:{label:"权重",prop:"weight"}},[n("el-input",{model:{value:e.info.weight,callback:function(t){e.$set(e.info,"weight",t)},expression:"info.weight"}})],1),e._v(" "),n("el-form-item",{staticClass:"flex-50",attrs:{label:"栏目字段",prop:"channelField"}},[n("el-input",{model:{value:e.info.channelField,callback:function(t){e.$set(e.info,"channelField",t)},expression:"info.channelField"}})],1),e._v(" "),n("el-form-item",{staticClass:"flex-50",attrs:{label:"接口名称",prop:"showName"}},[n("el-input",{model:{value:e.info.showName,callback:function(t){e.$set(e.info,"showName",t)},expression:"info.showName"}})],1),e._v(" "),n("el-form-item",{staticClass:"flex-50",attrs:{label:"栏目",prop:"siteId"}},[n("el-input",{staticClass:"cms-width",attrs:{value:e.selectedChannel},on:{focus:e.toggleShow}}),e._v(" "),e.showInputList?n("div",{staticStyle:{width:"100%"}},[n("div",{staticClass:"triangle"}),e._v(" "),n("div",{staticClass:"input-list"},[n("cms-tree",{attrs:{treeType:"page"},on:{click:e.getCurrentChannel}})],1)]):e._e()],1),e._v(" "),n("el-form-item",{staticClass:"flex-100",attrs:{label:"请求地址",prop:"url"}},[n("el-input",{model:{value:e.info.url,callback:function(t){e.$set(e.info,"url",t)},expression:"info.url"}})],1),e._v(" "),n("el-form-item",{staticClass:"flex-50",attrs:{label:"请求方式",prop:"method"}},[n("el-input",{model:{value:e.info.method,callback:function(t){e.$set(e.info,"method",t)},expression:"info.method"}})],1),e._v(" "),n("el-form-item",{staticClass:"flex-100",attrs:{label:"参数",prop:"params"}},[n("el-input",{model:{value:e.info.params,callback:function(t){e.$set(e.info,"params",t)},expression:"info.params"}})],1),e._v(" "),n("el-form-item",{staticClass:"flex-50",attrs:{label:"状态字段",prop:"status"}},[n("el-input",{model:{value:e.info.status,callback:function(t){e.$set(e.info,"status",t)},expression:"info.status"}})],1),e._v(" "),n("el-form-item",{staticClass:"flex-50",attrs:{label:"模型id",prop:"syncModelId"}},[n("el-input",{attrs:{disabled:""},model:{value:e.info.syncModelId,callback:function(t){e.$set(e.info,"syncModelId",t)},expression:"info.syncModelId"}})],1),e._v(" "),n("el-form-item",{staticClass:"flex-50",attrs:{label:"uuid",prop:"uuid"}},[n("el-input",{model:{value:e.info.uuid,callback:function(t){e.$set(e.info,"uuid",t)},expression:"info.uuid"}})],1),e._v(" "),e._l(e.formList,function(t,i){return n("el-form-item",{key:i,staticClass:"flex-50",attrs:{label:t.showName,prop:t.field}},[n("el-input",{attrs:{placeholder:t.description},model:{value:e.formValue[t.field],callback:function(n){e.$set(e.formValue,t.field,n)},expression:"formValue[item.field]"}})],1)}),e._v(" "),n("div",{staticClass:"form-footer"},[n("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("提交")]),e._v(" "),n("el-button",{attrs:{type:"info"},on:{click:e.reset}},[e._v("重置")])],1)],2)],1)},u=[],c={render:d,staticRenderFns:u},f=c,h=n("VU/8"),p=i,m=h(l,f,!1,p,null,null);t.default=m.exports},xMn1:function(e,t,n){t=e.exports=n("FZ+f")(!1),t.push([e.i,"\n@charset \"UTF-8\";\n.input-list {\n  width: 200px;\n  position: relative;\n  display: inline-block;\n  height: 200px;\n  z-index: 10;\n  border-radius: 4px;\n  -webkit-box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n          box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  overflow: auto;\n}\n.triangle {\n  margin-top: 10px;\n  margin-left: 15px;\n  width: 0;\n  height: 0;\n  border-width: 0 7px 7px;\n  border-style: solid;\n  border-color: transparent transparent #333;\n  /*透明 透明  灰*/\n  position: relative;\n  z-index: 9;\n}\n.triangle::after {\n  content: '';\n  margin-left: -6px;\n  display: block;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 6.5px 6.5px;\n  border-color: transparent transparent white;\n}\n.input-list > ul {\n  width: 100%;\n  display: inline-block;\n}\n.has-arrow, .has-not-arrow {\n  font-size: 14px;\n  padding: 8px 20px;\n  position: relative;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: #606266;\n  height: 34px;\n  line-height: 1.5;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  cursor: pointer;\n  outline: 0;\n}\n.has-arrow:after {\n  content: '>';\n  float: right;\n  color: #666666;\n}\n.has-not-arrow:after {\n  content: '>';\n  float: right;\n  color: transparent;\n}\n.bg-img {\n  display: block;\n  position: absolute;\n  width: 130px;\n  height: 130px;\n  border-radius: 6px;\n  background-repeat: no-repeat;\n  background-size: cover;\n  background-position: center;\n}\n",""])}});