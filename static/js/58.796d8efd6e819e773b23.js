webpackJsonp([58],{"2Il5":function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,"\n.w40p[data-v-7039eaa2] {\r\n  width: 35% !important;\n}\n.content-inner-box[data-v-7039eaa2]{\r\n  width: 400px;\r\n  position: relative;\r\n  left: -145px;\n}\n.inner-label[data-v-7039eaa2]{\r\n  display: inline-block;\r\n  text-align: right;\r\n  width: 95px;\r\n  margin-right: 22px;\n}\n.input-list[data-v-7039eaa2] {\r\n  width: 200px;\r\n  position: relative;\r\n  display: inline-block;\r\n  height: 200px;\r\n  z-index: 10;\r\n  border-radius: 4px;\r\n  -webkit-box-shadow: 0 2px 12px 0 rgba(0,0,0,.1);\r\n          box-shadow: 0 2px 12px 0 rgba(0,0,0,.1); \r\n  overflow: auto;\n}\n.triangle[data-v-7039eaa2] {\r\n  margin-top: 10px;\r\n  margin-left: 15px;\r\n  width:0;\r\n  height:0;\r\n  border-width:0 7px 7px;\r\n  border-style:solid;\r\n  border-color:transparent transparent #333;/*透明 透明  灰*/\r\n  position:relative;\r\n  z-index: 9;\n}\n.triangle[data-v-7039eaa2]::after {\r\n  content: '';\r\n  margin-left: -6px;\r\n  display: block;\r\n  width:0;\r\n  height:0;\r\n  border-style:solid;\r\n  border-width:0 6.5px 6.5px;\r\n  border-color:transparent transparent white;\n}\n.input-list>ul[data-v-7039eaa2] {\r\n  width: 100%;\r\n  display: inline-block;\n}\n.has-arrow[data-v-7039eaa2], .has-not-arrow[data-v-7039eaa2] {\r\n  font-size: 14px;\r\n  padding: 8px 20px;\r\n  position: relative;\r\n  white-space: nowrap;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  color: #606266;\r\n  height: 34px;\r\n  line-height: 1.5;\r\n  -webkit-box-sizing: border-box;\r\n          box-sizing: border-box;\r\n  cursor: pointer;\r\n  outline: 0;\n}\n.has-arrow[data-v-7039eaa2]:after {\r\n  content: '>';\r\n  float: right;\r\n  color: #666666;\n}\n.has-not-arrow[data-v-7039eaa2]:after {\r\n  content: '>';\r\n  float: right;\r\n  color: transparent;\n}\n.bg-img[data-v-7039eaa2] {\r\n  display: block;\r\n  position: absolute;\r\n  width: 130px;\r\n  height: 130px;\r\n  border-radius: 6px;\r\n  background-repeat: no-repeat;\r\n  background-size: cover;\r\n  background-position: center;\n}\r\n",""])},KNay:function(e,t,a){"use strict";function r(e){a("QTNC")}Object.defineProperty(t,"__esModule",{value:!0});var n=a("lcoF"),i=(a("mtWM"),a("nSkA")),s=a("x1ym"),o={mixins:[n.a],data:function(){var e=s.a.required("此项必填"),t=s.a.number("只能输入数字");s.a.string("只能输入英文字母");return{formList:[],formValue:{},title:"",cookie:!0,info:{modelId:null},storageId:null,value:"",params:this.$route.query,rules:{parentId:[e],typeId:[e,t]},channelList:[],itemList:[],topicList:[],typeList:[],groupList:[],workflowList:[],chargeMap:[],tplAll:[],isTypeImg:!1,selectId:0,props:{label:"name",children:"zones",isLeaf:"isChild",id:"id"},spName:"",channelVisble:!1,showInputList:!1,selectedChannel:null,showChildList:!1,childrenList:[],showGrandList:!1,grandList:[],chosenList:[],finalChannelId:null,chosenSubChannelList:[],chosenSubChannelArray:[],currentLevel:"",storageEnable:1,postAttrs:[],ue:[],checkList:[],poster:"",showImage:!0,showSubTree:!0}},methods:{getUrl:function(e,t,a,r){this.formValue[t]=e,this.storageId=r,this.poster=a},getUeditor:function(e,t){this.ue[t]=e},getDocTxt:function(e,t){this.ue[t].execCommand("inserthtml",e)},getEditorContent:function(e){this.formValue[e]=this.ue[e].getContent()},getChosenChannel:function(e){this.chosenSubChannelList=e.checkedNodes;for(var t=0;t<this.chosenSubChannelList.length;t++)this.chosenSubChannelArray.push(this.chosenSubChannelList[t].id)},chooseSubChannel:function(){this.channelVisble=!1,this.info.channelIds=this.chosenSubChannelArray},getCurrentChannel:function(e,t){void 0!=t.parent.data&&(this.selectedChannel=e.name,void 0!=t.parent.parent.data&&(this.selectedChannel=t.parent.data.name+"/"+e.name,void 0!=t.parent.parent.parent.data&&(this.selectedChannel=t.parent.parent.data.name+"/"+t.parent.data.name+"/"+e.name))),this.finalChannelId=e.id,this.showInputList=!1,window.localStorage.setItem("channelShowList",this.selectedChannel),window.localStorage.setItem("chosenId",this.finalChannelId)},toggleShow:function(){0==this.showInputList?this.showInputList=!0:this.showInputList=!1},getChannelTree:function(e){var t=this,a=this.$api;this.rotating=!0,i.a.get(a.contentTree+"/"+e).then(function(e){if("0"==e.data.errorCode){e.data.data;t.options2=e.data.data}else e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("操作失败")}).catch(function(e){t.rotating=!1})},reset:function(){var e=this;this.showImage=!1,this.showSubTree=!1,setTimeout(function(){e.showImage=!0,e.showSubTree=!0},100),this.resetDataInfo(this.formValue)},back:function(){this.routerLink("/content/list","list",this.params.parentId)},getChannelId:function(e,t){this.routerLink("/content/list","list",e.id)},resort:function(e){for(var t=0;t<e.length-1;t++)for(var a=0;a<e.length-1-t;a++)if(e[a].priority>e[a+1].priority){var r=e[a];e[a]=e[a+1],e[a+1]=r}return e},getDataInfo:function(){var e=this;this.loading=!0;var t=this.info.modelId;i.a.get(this.$api.itemGet+"/"+t).then(function(t){if(e.loading=!1,"0"==t.data.errorCode){e.formList=e.resort(t.data.data).reverse();for(var a in e.formList){if(1==e.formList[a].isRequire){var r={},n=[];n.push(r),r.message="此项必填",r.required=!0,r.trigger="blur",r.validator=function(e,t,a){},e.$set(e.rules,e.formList[a].field),e.rules[e.formList[a].field]=n}e.$set(e.formValue,e.formList[a].field),7==e.formList[a].dataType?e.formValue[e.formList[a].field]=e.formList[a].defValue.split(","):e.formValue[e.formList[a].field]=e.formList[a].defValue}}else t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("操作失败")}).catch(function(t){console.log(t),e.loading=!1})},getFormData:function(){this.formList},getChannelList:function(e){var t=this,a=this.$api;i.a.get(a.contentTree+"/"+e).then(function(e){if("0"==e.data.errorCode){t.rotating=!1;t.channelList=e.data.data}else e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("操作失败")}).catch(function(e){t.rotating=!1})},getParams:function(){var e={},t=[];for(var a in this.formValue)e.attrObj={},void 0!=this.formValue[a]&&(e.attrObj.attrName=a,this.formValue[a]instanceof Array?e.attrObj.attrValue=this.formValue[a].join(","):e.attrObj.attrValue=this.formValue[a],t.push(e.attrObj),e.attr=t);return delete e.attrObj,e.channelId=parseInt(this.finalChannelId),e.modelId=this.info.modelId,e.storageId=this.storageId,e.parentId=this.info.parentId,e.poster=this.poster,e.spName=this.spName,e.title=this.title,e.siteId=1,e.status=0,e.topLevel=0,e.weight=0,e.channelIds=this.info.channelIds,e},saves:function(e,t){var a=this,r=this.$api.contentSave;this.$refs.form;i.a.post(r,t).then(function(t){"0"==t.data.errorCode?(a.successMessage("添加成功"),e?a.reset():setTimeout(function(){a.routerLink("/content/list")},1e3)):t.data.errorMessage?a.errorMessage(t.data.errorMessage):a.errorMessage("添加失败")})},add:function(e,t){for(var a=0;a<this.formList.length;a++)if(11==this.formList[a].dataType&&this.getEditorContent(this.formList[a].field),"title"==this.formList[a].field&&(this.formValue[this.formList[a].field]=this.title),"poster"==this.formList[a].field&&(this.formValue[this.formList[a].field]=this.poster),"spName"==this.formList[a].field&&(this.formValue[this.formList[a].field]=this.spName),this.formList[a].isRequire&&(void 0==this.formValue[this.formList[a].field]||""==this.formValue[this.formList[a].field]))return this.errorMessage("请补全"+this.formList[a].showName),!1;var r=this.getParams();if(isNaN(r.channelId))return this.errorMessage("请选择一个栏目"),!1;this.saves(e,r)}},created:function(){this.$store.dispatch("setCollapse",!0),this.info.modelId=parseInt(this.params.modelId),this.getDataInfo(),this.getChannelTree(0)},mounted:function(){this.selectedChannel=window.localStorage.getItem("channelShowList"),this.finalChannelId=window.localStorage.getItem("chosenId");var e=document.body.clientHeight;$(".cms-body").css("minHeight",e-110+"px")}},l=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"cms-body flex tree-bottom"},[a("a",{staticClass:"cms-back",attrs:{href:"javascript:void(0)"},on:{click:e.back}}),e._v(" "),a("cms-tree",{attrs:{treeType:"page"},on:{change:e.getChannelId}}),e._v(" "),a("div",{staticClass:"cms-content-right"},[a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",staticClass:"cms-form",attrs:{model:e.info,rules:e.rules,"label-width":"162px"}},[a("el-form-item",{staticClass:"flex-50",attrs:{label:"选择栏目",prop:"parentId"}},[a("el-input",{staticClass:"cms-width",attrs:{value:e.selectedChannel},on:{focus:e.toggleShow}}),e._v(" "),e.showInputList?a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"triangle"}),e._v(" "),a("div",{staticClass:"input-list"},[a("cms-tree",{attrs:{treeType:"page"},on:{click:e.getCurrentChannel}})],1)]):e._e()],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"关联副栏目"}},[a("el-button",{on:{click:function(t){e.channelVisble=!0}}},[e._v("关联副栏目")])],1),e._v(" "),a("el-dialog",{staticClass:"dialog",attrs:{title:"选择副栏目",visible:e.channelVisble,width:"30%"},on:{"update:visible":function(t){e.channelVisble=t}}},[a("div",{staticClass:"tree-layout"},[e.showSubTree?a("div",{staticClass:"tree"},[a("cms-tree",{attrs:{treeType:"component"},on:{change:e.getChosenChannel}})],1):e._e()]),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.channelVisble=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.chooseSubChannel}},[e._v("选择")])],1)]),e._v(" "),e._l(e.formList,function(t,r){return a("el-form-item",{key:r,class:t.single?"flex-100":"flex-50",attrs:{label:t.showName,prop:t.field}},["spName"==t.field?a("div",[a("el-input",{attrs:{placeholder:"sp名称"},model:{value:e.spName,callback:function(t){e.spName=t},expression:"spName"}})],1):a("div",[1==t.dataType&&"title"==t.field?a("el-input",{attrs:{placeholder:t.description},model:{value:e.title,callback:function(t){e.title=t},expression:"title"}}):e._e(),e._v(" "),1==t.dataType&&"title"!==t.field?a("el-input",{attrs:{placeholder:t.description},model:{value:e.formValue[t.field],callback:function(a){e.$set(e.formValue,t.field,a)},expression:"formValue[item.field]"}}):e._e()],1),e._v(" "),2==t.dataType?a("el-input",{attrs:{placeholder:t.description,type:"number"},model:{value:e.formValue[t.field],callback:function(a){e.$set(e.formValue,t.field,a)},expression:"formValue[item.field]"}}):e._e(),e._v(" "),3==t.dataType?a("el-input",{attrs:{placeholder:t.description,type:"number"},model:{value:e.formValue[t.field],callback:function(a){e.$set(e.formValue,t.field,a)},expression:"formValue[item.field]"}}):e._e(),e._v(" "),4==t.dataType?a("el-input",{attrs:{type:"textarea",rows:2,placeholder:t.description},model:{value:e.formValue[t.field],callback:function(a){e.$set(e.formValue,t.field,a)},expression:"formValue[item.field]"}}):e._e(),e._v(" "),5==t.dataType?a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期"},model:{value:e.formValue[t.field],callback:function(a){e.$set(e.formValue,t.field,a)},expression:"formValue[item.field]"}}):e._e(),e._v(" "),7==t.dataType?a("el-checkbox-group",{model:{value:e.formValue[t.field],callback:function(a){e.$set(e.formValue,t.field,a)},expression:"formValue[item.field]"}},e._l(t.optValue.split(","),function(e,t){return a("el-checkbox",{key:t,attrs:{label:e}})})):e._e(),e._v(" "),6==t.dataType?a("el-select",{attrs:{placeholder:"请选择"},model:{value:e.formValue[t.field],callback:function(a){e.$set(e.formValue,t.field,a)},expression:"formValue[item.field]"}},e._l(t.optValue.split(","),function(e,t){return a("el-option",{key:t,attrs:{label:e,value:e}})})):e._e(),e._v(" "),8==t.dataType?a("el-radio-group",{model:{value:e.formValue[t.field],callback:function(a){e.$set(e.formValue,t.field,a)},expression:"formValue[item.field]"}},e._l(t.optValue.split(","),function(e,t){return a("el-radio",{key:t,attrs:{label:e}})})):e._e(),e._v(" "),10==t.dataType&&e.showImage?a("uploader",{attrs:{index:t.field},on:{change:e.getUrl}}):e._e(),e._v(" "),11==t.dataType?a("cms-editor",{attrs:{defaultMsg:e.formValue[t.field],index:t.field},on:{ready:e.getUeditor}}):e._e()],1)}),e._v(" "),a("div",{staticClass:"form-footer"},[0==this.id?a("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/content/save",expression:"'/content/save'"}],attrs:{type:"warning"},on:{click:function(t){e.add(!0)}}},[e._v("提交并继续添加")]):e._e(),e._v(" "),0==this.id?a("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/content/save",expression:"'/content/save'"}],attrs:{type:"primary"},on:{click:function(t){e.add(!1)}}},[e._v("提交")]):e._e(),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.reset}},[e._v("重置")])],1)],2)],1)],1)},d=[],h={render:l,staticRenderFns:d},c=h,f=a("VU/8"),u=r,p=f(o,c,!1,u,"data-v-7039eaa2",null);t.default=p.exports},QTNC:function(e,t,a){var r=a("2Il5");"string"==typeof r&&(r=[[e.i,r,""]]),r.locals&&(e.exports=r.locals);a("rjj0")("6e6371f9",r,!0,{})}});