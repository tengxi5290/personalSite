(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-59c133cc"],{"52a5":function(t,e,a){},"8d3b":function(t,e,a){"use strict";a.r(e);var s=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"content-list"},[a("div",{staticClass:"mobile-interaction-bar"},[a("van-button",{attrs:{type:"primary",size:"small",icon:"replay"},on:{click:function(e){return t.moreAction(null,"async")}}},[t._v("同步")]),a("van-button",{staticClass:"bothSide",attrs:{type:"warning",size:"small",icon:"search"},on:{click:function(e){return t.moreAction(null,"search")}}},[t._v("筛选")]),a("van-button",{attrs:{type:"info",size:"small",icon:"apps-o"},on:{click:function(e){return t.moreAction(null,"channel")}}},[t._v("栏目")])],1),a("div",{staticClass:"mobile-content-bar"},[a("van-pull-refresh",{attrs:{offset:"100"},on:{refresh:t.onRefresh},model:{value:t.refreshing,callback:function(e){t.refreshing=e},expression:"refreshing"}},[a("van-list",{attrs:{finished:t.finished,"finished-text":"没有更多了"},on:{load:t.onLoad},model:{value:t.loading,callback:function(e){t.loading=e},expression:"loading"}},t._l(t.tableData,(function(e,s){return a("van-cell",{key:s},[a("van-card",{attrs:{tag:e.feeType,desc:e.publishTime,title:e.title,thumb:e.poster},scopedSlots:t._u([{key:"tags",fn:function(){return[e.topLevel?a("van-tag",{attrs:{plain:"",type:"primary"}},[t._v("[顶]")]):t._e(),e.downloadType?t._e():a("van-tag",{staticClass:"m-left-10",attrs:{plain:"",type:"danger"}},[t._v("[禁]")]),1==e.showType?a("van-tag",{staticClass:"m-left-10",attrs:{plain:"",type:"default"}},[t._v("[原创]")]):t._e(),2==e.showType?a("van-tag",{staticClass:"m-left-10",attrs:{plain:"",type:"warning"}},[t._v("[热HOT]")]):t._e(),a("van-tag",{staticClass:"m-left-10",attrs:{type:"success"}},[t._v(t._s(e.spName))]),a("van-tag",{staticClass:"m-left-10",attrs:{type:"success"}},[t._v(t._s(e.modelShowName))])]},proxy:!0},{key:"footer",fn:function(){return[e.topLevel?t._e():a("van-button",{attrs:{size:"small",icon:"back-top",type:"primary"},on:{click:function(a){return t.moreAction(e,"top")}}}),e.topLevel?a("van-button",{attrs:{size:"small",icon:"down",color:"indianred"},on:{click:function(a){return t.moreAction(e,"top")}}}):t._e(),a("van-button",{attrs:{size:"small",icon:"setting-o",type:"info"},on:{click:function(a){return t.moreAction(e,"more")}}}),a("van-button",{attrs:{size:"small",icon:"friends-o",type:"warning"},on:{click:function(a){return t.moreAction(e,"group")}}})]},proxy:!0},{key:"bottom",fn:function(){return[a("van-tag",{attrs:{plain:"",type:"info"}})]},proxy:!0}],null,!0)})],1)})),1)],1)],1),a("div",{staticClass:"mobile-more-action-bar"},["async"==t.currentAction?a("van-popup",{attrs:{round:"",position:"bottom"},model:{value:t.visibleObj.showPicker,callback:function(e){t.$set(t.visibleObj,"showPicker",e)},expression:"visibleObj.showPicker"}},[a("van-picker",{attrs:{"show-toolbar":"",columns:t.columns},on:{cancel:function(e){t.visibleObj.showPicker=!1},confirm:t.onConfirm}})],1):t._e(),a("van-popup",{style:{height:"100%",width:"100%"},attrs:{position:"right"},model:{value:t.visibleObj.showPop,callback:function(e){t.$set(t.visibleObj,"showPop",e)},expression:"visibleObj.showPop"}},[a("div",{staticClass:"search-container"},[a("van-search",{attrs:{placeholder:"请输入文章标题","show-action":"",label:"标题"},on:{search:function(e){return t.onSearch("title")}},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:function(e){return t.onSearch("title")}}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.queryParams.title,callback:function(e){t.$set(t.queryParams,"title",e)},expression:"queryParams.title"}}),a("van-search",{attrs:{placeholder:"请输入spId","show-action":"",label:"spId"},on:{search:function(e){return t.onSearch("spId")}},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:function(e){return t.onSearch("spId")}}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.queryParams.spId,callback:function(e){t.$set(t.queryParams,"spId",e)},expression:"queryParams.spId"}}),a("van-search",{attrs:{placeholder:"请输入id","show-action":"",label:"id"},on:{search:function(e){return t.onSearch("id")}},scopedSlots:t._u([{key:"action",fn:function(){return[a("div",{on:{click:function(e){return t.onSearch("id")}}},[t._v("搜索")])]},proxy:!0}]),model:{value:t.queryParams.id,callback:function(e){t.$set(t.queryParams,"id",e)},expression:"queryParams.id"}}),a("van-divider"),a("van-picker",{attrs:{"show-toolbar":"",title:"其他筛选",columns:t.selections},on:{confirm:t.doQuery,cancel:function(e){t.visibleObj.showPop=!1}}})],1)])],1)])},i=[],n=a("9ab4"),o=a("60a3"),l=a("1ec2");class r{constructor(t=null){this.basicMap=t=new Map,t.set("所有状态","-1"),t.set("待编辑","0"),t.set("草稿","1"),t.set("审核拒绝","4"),t.set("已上线","5"),t.set("已下线","6"),t.set("删除","7"),t.set("禁用","8"),t.set("收费","10")}getVal(t){let e=this.basicMap.get(t);return e}getKey(t){let e="";return this.basicMap.forEach((a,s)=>{t==a&&(e=s)}),e}}class c{constructor(t=null){this.basicMap=t=new Map,t.set("所有类型","-1"),t.set("免费","0"),t.set("积分付费","1"),t.set("人民币付费","2"),t.set("试听","4"),t.set("专辑付费","5"),t.set("兑换码付费","6")}getVal(t){let e=this.basicMap.get(t);return e}getKey(t){let e="";return this.basicMap.forEach((a,s)=>{t==a&&(e=s)}),e}}let p=class extends o["b"]{constructor(){super(...arguments),this.pageObj={allTotal:0,totalPages:0,curPage:1,pageSize:10,page:0},this.queryParams={title:"",spId:"",id:"",productType:"",modelId:"",status:""},this.tableData=[]}mounted(){}onSearch(t){this["tableData"]=[],this["pageObj"]["page"]=0,this.getTableData(1,10,t+"="+this["queryParams"][t]),this["visibleObj"]["showPop"]=!1}getTableData(t=1,e=10,...a){let s=this.$collectUrl("contentList")+"?page="+t+"&pageSize="+e,i=[...a];i.forEach((t,e)=>{let a=t.charAt(t.length-1),i=t.substring(t.length-2);-1!==Number(i)&&"="!==a&&(s+="&"+t)});let n=new Promise((t,e)=>{l["a"].get(s).then(e=>{Object(l["b"])(e).then(a=>{this["tableData"]=[...this["tableData"],...e.data.data.list],this["pageObj"]["allTotal"]=e.data.data.total,this["pageObj"]["totalPages"]=e.data.data.pages,this["pageObj"]["curPage"]=e.data.data.pageNum,this["tableData"].map((t,e)=>{t.publishTime&&(t.publishTime=Object(l["d"])(t.publishTime));let a=new Map;a.set(0,"免费"),a.set(1,"积分"),a.set(2,"RMB"),a.set(4,"试听"),a.set(5,"专辑"),a.set(6,"兑码"),t.feeType=a.get(parseInt(t.productType))?a.get(parseInt(t.productType)):"免费"}),t()})}).catch(t=>{console.warn(t)})});return n}};p=Object(n["a"])([Object(o["a"])({})],p);var h=p,u=a("3089");o["b"].use(u["Button"]),o["b"].use(u["List"]),o["b"].use(u["PullRefresh"]),o["b"].use(u["Card"]),o["b"].use(u["Cell"]),o["b"].use(u["Tag"]),o["b"].use(u["Picker"]),o["b"].use(u["Search"]),o["b"].use(u["Divider"]);let d=class extends o["b"]{constructor(){super(...arguments),this.loading=!1,this.finished=!1,this.refreshing=!1,this.columns=[],this.selections=[{values:[],defaultIndex:1,searchType:"productType"},{values:[],defaultIndex:4,searchType:"status"},{values:[],defaultIndex:0,searchType:"modelId"}],this.apiMap=null,this.modelMap=null,this.currentAction="",this.visibleObj={showPicker:!1,showPop:!1}}mounted(){this.getApiList(),this.getModelList(),this.selections[1].values=Array.from(new r(null).basicMap.keys()),this.selections[0].values=Array.from(new c(null).basicMap.keys())}doQuery(t,e){this["queryParams"]["status"]=new r(null).getVal(t[1]),this["queryParams"]["productType"]=new c(null).getVal(t[0]),this["queryParams"]["modelId"]=this.modelMap.get(t[2]),this["tableData"]=[],this["pageObj"]["page"]=1,this["getTableData"](this["pageObj"]["page"],this["pageObj"]["pageSize"],"productType="+this["queryParams"]["productType"],"modelId="+this["queryParams"]["modelId"],"status="+this["queryParams"]["status"]).then(()=>{this.visibleObj.showPop=!1})}onConfirm(t){let e=this.apiMap.get(t),a=window.localStorage.getItem("_site_id_param"),s="http://cmstest.cnlive.com:8083/job/getcontent/"+a;-1!==this.apiMap.get(t)&&(s+="/"+e),Object(l["c"])("操作成功",null),l["a"].get(s).then(t=>{this["tableData"]=[],this["pageObj"]["page"]=0,this.onLoad(),this.visibleObj.showPicker=!1}).catch(t=>{console.warn(t)})}getApiList(){let t=this.$collectUrl("syncApiList");l["a"].get(t).then(t=>{Object(l["b"])(t).then(e=>{let a=t.data.data;this.apiMap=new Map,this.apiMap.set("全部",-1),a.forEach((t,e)=>{0==t.enable&&a.splice(e,1),this.apiMap.set(t.showName,t.id)}),this.columns=Array.from(this.apiMap.keys())})}).catch(t=>{console.warn(t)})}getModelList(){let t=this.$collectUrl("modelList")+"?enable=true";l["a"].get(t).then(t=>{Object(l["b"])(t).then(e=>{let a=t.data.data;window.localStorage.setItem("modelList",JSON.stringify(a)),this.modelMap=new Map,this.modelMap.set("所有模型",-1),a.forEach((t,e)=>{this.modelMap.set(t.showName,t.id)}),this.selections[2].values=Array.from(this.modelMap.keys())}).catch(t=>{console.warn(t)})})}switchActionType(t,e){let a={group:()=>{console.log("去关联群组")},async:()=>{console.log("开始选择"),this.visibleObj.showPicker=!0},search:()=>{console.log("筛选"),this.visibleObj.showPop=!0},channel:()=>{console.log("选择栏目")},top:()=>{console.log("置顶和取消置顶");let t,a=e.id;t=!e.topLevel;let s=this.$collectUrl("contentTop");l["a"].put(s+"?id="+a+"&isTop="+t).then(t=>{Object(l["b"])(t).then(t=>{Object(l["c"])("操作成功",null),this["tableData"]=[],this["pageObj"]["page"]=0,this.onLoad()})}).catch(t=>{console.warn(t)})},more:()=>{console.log("其他操作")}};return"function"===typeof a[t]&&(this.currentAction=t,a[t])}moreAction(t,e){this.switchActionType(e,t)()}onLoad(){this.refreshing&&(this.refreshing=!1),this["pageObj"]["page"]+=1,this["getTableData"](this["pageObj"]["page"],this["pageObj"]["pageSize"],"productType="+this["queryParams"]["productType"],"modelId="+this["queryParams"]["modelId"],"status="+this["queryParams"]["status"]).then(()=>{}),this.loading=!1,this["pageObj"]["page"]==this["pageObj"]["totalPages"]&&(this.finished=!0)}onRefresh(){this.finished=!1,this.loading=!0,this["pageObj"]["page"]=0,this["tableData"].length=0,this.onLoad()}};d=Object(n["a"])([Object(o["a"])({mixins:[h]})],d);var b=d,g=b,m=(a("d82c"),a("2877")),f=Object(m["a"])(g,s,i,!1,null,"8490f5c8",null);e["default"]=f.exports},d82c:function(t,e,a){"use strict";var s=a("52a5"),i=a.n(s);i.a}}]);
//# sourceMappingURL=chunk-59c133cc.b3ed2601.js.map