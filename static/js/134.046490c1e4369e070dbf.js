webpackJsonp([134],{"7iDR":function(e,t,a){var n=a("tkt9");"string"==typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);a("rjj0")("1138dc9c",n,!0,{})},"gPb+":function(e,t,a){"use strict";function n(e){a("7iDR")}Object.defineProperty(t,"__esModule",{value:!0});var o=a("5HJ5"),i=a("lcoF"),r=(a("mtWM"),a("x1ym")),s=a("nSkA"),l={mixins:[o.a,i.a],data:function(){var e=r.a.required("此项必填");r.a.number("只能输入数字");return{syncContentId:null,currentSyncModel:null,currentModelId:null,formList:[],rules:{rule:[e],showName:[e]},formData:[],info:{enable:!1,rule:null,showName:"",method:"",modelField:"",params:"",status:"",syncModelId:null,url:"",uuid:"",weight:"",channelField:"",siteId:null},formValue:{},ue:[],selectedChannel:null,showInputList:!1,finalChannelId:null,currentChannelGroup:[]}},methods:{getModelId:function(){var e=this;s.a.get(this.$api.syncModel+"/"+this.currentSyncModel).then(function(t){"0"==t.data.errorCode?(e.currentModelId=t.data.data.modelId,e.getContentDetail()):t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("请求失败")}).catch(function(e){console.log(e)})},getModelItems:function(e){var t=this;s.a.get(this.$api.itemGet+"/"+this.currentModelId).then(function(a){if(t.loading=!1,"0"==a.data.errorCode){t.formList=t.resort(a.data.data).reverse();var n=void 0;for(var o in t.formList)7==t.formList[o].dataType&&(n=t.formList[o].field);e(n)}else a.data.errorMessage?t.errorMessage(a.data.errorMessage):t.errorMessage("请求失败")}).catch(function(e){t.loading=!1,console.log(e)})},getContentDetail:function(){var e=this;s.a.get(this.$api.syncApiDetail+"/"+this.syncContentId).then(function(t){if("0"==t.data.errorCode){console.log("栏目要怎么体现呢"),console.log(t.data.data),e.formData=t.data.data.cmsSyncContentAttr,e.info.channelField=t.data.data.channelField,e.info.enable=t.data.data.enable,e.info.method=t.data.data.method,e.info.params=t.data.data.params,e.info.rule=t.data.data.rule,e.info.showName=t.data.data.showName,e.info.status=t.data.data.status,e.info.syncModelId=t.data.data.modelId,e.info.url=t.data.data.url,e.info.uuid=t.data.data.uuid,e.info.weight=t.data.data.weight,e.info.id=t.data.data.id;var a=t.data.data.channelId;null!==a&&""!==a&&void 0!==a&&e.getChannel(a),e.getModelItems(function(t){for(var a in e.formData)e.$set(e.formValue,e.formData[a].contentAttrName),e.formValue[e.formData[a].contentAttrName]=e.formData[a].syncAttrName})}else t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("请求失败")}).catch(function(e){console.log(e)})},resort:function(e){for(var t=0;t<e.length-1;t++)for(var a=0;a<e.length-1-t;a++)if(e[a].priority>e[a+1].priority){var n=e[a];e[a]=e[a+1],e[a+1]=n}return e},getUrl:function(e,t,a,n){this.formValue[t]=e,this.storageId=n,this.poster=a},getUeditor:function(e,t){this.ue[t]=e},getDocTxt:function(e,t){this.ue[t].execCommand("inserthtml",e)},getEditorContent:function(e){this.formValue[e]=this.ue[e].getContent()},getParams:function(){var e={},t=[];for(var a in this.formValue)e.attrObj={},void 0!=this.formValue[a]&&(e.attrObj.contentAttrName=a,this.formValue[a]instanceof Array?e.attrObj.syncAttrName=this.formValue[a].join(","):e.attrObj.syncAttrName=this.formValue[a],t.push(e.attrObj),e.cmsSyncContentAttr=t);return delete e.attrObj,e.enable=this.info.enable,e.method=this.info.method,e.params=this.info.params,e.channelId=this.finalChannelId,e.rule=this.info.rule,e.showName=this.info.showName,e.status=this.info.status,e.modelId=parseInt(this.currentSyncModel),e.url=this.info.url,e.uuid=this.info.uuid,e.weight=this.info.weight+"","null"==this.info.weight||"undefined"==this.info.weight||""==this.info.weight?e.weight="":e.weight=this.info.weight+"",e.channelField=this.info.channelField,e.id=this.info.id,e},update:function(){var e=this.getParams();this.saves(e)},saves:function(e){var t=this,a=this.$api.syncApiUpdate;s.a.put(a,e).then(function(e){"0"==e.data.errorCode?(t.successMessage("操作成功"),setTimeout(function(){t.routerLink("/sync/api")},1e3)):e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("操作失败")})},reset:function(){this.resetDataInfo(this.formValue)},back:function(){this.routerLink("/sync/api")},toggleShow:function(){0==this.showInputList?this.showInputList=!0:this.showInputList=!1},getChannel:function(e){var t=this;s.a.get(this.$api.channelInfo+"/"+e).then(function(e){"0"==e.data.errorCode?(t.currentChannelGroup.push(e.data.data.name),e.data.data.parentId&&t.getChannel(e.data.data.parentId),t.currentChannelGroup=t.currentChannelGroup.reverse(),t.selectedChannel=t.currentChannelGroup.join("/")):e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("操作失败")})},getCurrentChannel:function(e,t){void 0!=t.parent.data&&(this.selectedChannel=e.name,void 0!=t.parent.parent.data&&(this.selectedChannel=t.parent.data.name+","+e.name,void 0!=t.parent.parent.parent.data&&(this.selectedChannel=t.parent.parent.data.name+","+t.parent.data.name+","+e.name))),this.finalChannelId=e.id,this.showInputList=!1}},mounted:function(){this.syncContentId=this.$route.query.id,this.currentSyncModel=this.$route.query.syncModelId,this.currentModelId=this.$route.query.modelId,this.getContentDetail(),this.$store.dispatch("setCollapse",!0)}},d=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"cms-body flex"},[a("a",{staticClass:"cms-back",attrs:{href:"javascript:void(0)"},on:{click:e.back}}),e._v(" "),a("el-form",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"form",staticClass:"cms-form",attrs:{model:e.info,rules:e.rules,"label-width":"162px"}},[a("el-form-item",{staticClass:"flex-50",attrs:{label:"可用",prop:"enable"}},[a("el-radio-group",{model:{value:e.info.enable,callback:function(t){e.$set(e.info,"enable",t)},expression:"info.enable"}},[a("el-radio",{attrs:{label:!0}},[e._v("可用")]),e._v(" "),a("el-radio",{attrs:{label:!1}},[e._v("不可用")])],1)],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"匹配方式",prop:"rule"}},[a("el-radio-group",{model:{value:e.info.rule,callback:function(t){e.$set(e.info,"rule",t)},expression:"info.rule"}},[a("el-radio",{attrs:{label:1}},[e._v("主栏目路径")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("全路径")])],1)],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"权重",prop:"weight"}},[a("el-input",{model:{value:e.info.weight,callback:function(t){e.$set(e.info,"weight",t)},expression:"info.weight"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"栏目字段",prop:"channelField"}},[a("el-input",{model:{value:e.info.channelField,callback:function(t){e.$set(e.info,"channelField",t)},expression:"info.channelField"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"接口名称",prop:"showName"}},[a("el-input",{model:{value:e.info.showName,callback:function(t){e.$set(e.info,"showName",t)},expression:"info.showName"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"栏目",prop:"siteId"}},[a("el-input",{staticClass:"cms-width",attrs:{value:e.selectedChannel},on:{focus:e.toggleShow}}),e._v(" "),e.showInputList?a("div",{staticStyle:{width:"100%"}},[a("div",{staticClass:"triangle"}),e._v(" "),a("div",{staticClass:"input-list"},[a("cms-tree",{attrs:{treeType:"page"},on:{click:e.getCurrentChannel}})],1)]):e._e()],1),e._v(" "),a("el-form-item",{staticClass:"flex-100",attrs:{label:"请求地址",prop:"url"}},[a("el-input",{model:{value:e.info.url,callback:function(t){e.$set(e.info,"url",t)},expression:"info.url"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"请求方式",prop:"method"}},[a("el-input",{model:{value:e.info.method,callback:function(t){e.$set(e.info,"method",t)},expression:"info.method"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-100",attrs:{label:"参数",prop:"params"}},[a("el-input",{model:{value:e.info.params,callback:function(t){e.$set(e.info,"params",t)},expression:"info.params"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"状态字段",prop:"status"}},[a("el-input",{model:{value:e.info.status,callback:function(t){e.$set(e.info,"status",t)},expression:"info.status"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"模型id",prop:"syncModelId"}},[a("el-input",{attrs:{disabled:""},model:{value:e.info.syncModelId,callback:function(t){e.$set(e.info,"syncModelId",t)},expression:"info.syncModelId"}})],1),e._v(" "),a("el-form-item",{staticClass:"flex-50",attrs:{label:"uuid",prop:"uuid"}},[a("el-input",{model:{value:e.info.uuid,callback:function(t){e.$set(e.info,"uuid",t)},expression:"info.uuid"}})],1),e._v(" "),e._l(e.formList,function(t,n){return a("el-form-item",{key:n,staticClass:"flex-50",attrs:{label:t.showName,prop:t.field}},[a("el-input",{attrs:{placeholder:t.description},model:{value:e.formValue[t.field],callback:function(a){e.$set(e.formValue,t.field,a)},expression:"formValue[item.field]"}})],1)}),e._v(" "),a("div",{staticClass:"form-footer"},[a("el-button",{attrs:{type:"primary"},on:{click:e.update}},[e._v("更新")]),e._v(" "),a("el-button",{attrs:{type:"info"},on:{click:e.reset}},[e._v("重置")])],1)],2)],1)},u=[],c={render:d,staticRenderFns:u},f=c,h=a("VU/8"),p=n,m=h(l,f,!1,p,null,null);t.default=m.exports},tkt9:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,"\n@charset \"UTF-8\";\n.input-list {\n  width: 200px;\n  position: relative;\n  display: inline-block;\n  height: 200px;\n  z-index: 10;\n  border-radius: 4px;\n  -webkit-box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n          box-shadow: 0 2px 12px 0 rgba(0, 0, 0, 0.1);\n  overflow: auto;\n}\n.triangle {\n  margin-top: 10px;\n  margin-left: 15px;\n  width: 0;\n  height: 0;\n  border-width: 0 7px 7px;\n  border-style: solid;\n  border-color: transparent transparent #333;\n  /*透明 透明  灰*/\n  position: relative;\n  z-index: 9;\n}\n.triangle::after {\n  content: '';\n  margin-left: -6px;\n  display: block;\n  width: 0;\n  height: 0;\n  border-style: solid;\n  border-width: 0 6.5px 6.5px;\n  border-color: transparent transparent white;\n}\n.input-list > ul {\n  width: 100%;\n  display: inline-block;\n}\n.has-arrow, .has-not-arrow {\n  font-size: 14px;\n  padding: 8px 20px;\n  position: relative;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: #606266;\n  height: 34px;\n  line-height: 1.5;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  cursor: pointer;\n  outline: 0;\n}\n.has-arrow:after {\n  content: '>';\n  float: right;\n  color: #666666;\n}\n.has-not-arrow:after {\n  content: '>';\n  float: right;\n  color: transparent;\n}\n.bg-img {\n  display: block;\n  position: absolute;\n  width: 130px;\n  height: 130px;\n  border-radius: 6px;\n  background-repeat: no-repeat;\n  background-size: cover;\n  background-position: center;\n}\n",""])}});