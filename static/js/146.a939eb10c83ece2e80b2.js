webpackJsonp([146],{"2swh":function(t,n,e){n=t.exports=e("FZ+f")(!1),n.push([t.i,"\n.model-select[data-v-31af7fc5]{\n        margin-bottom: 12px;\n}\n.input-list[data-v-31af7fc5] {\n  width: 100%;\n  position: relative;\n  display: inline-block;\n  height: 200px;\n  z-index: 10;\n  border-radius: 4px;\n  -webkit-box-shadow: 0 2px 12px 0 rgba(0,0,0,.1);\n          box-shadow: 0 2px 12px 0 rgba(0,0,0,.1); \n  overflow: auto;\n}\n.triangle[data-v-31af7fc5] {\n  margin-top: 10px;\n  margin-left: 15px;\n  width:0;\n  height:0;\n  border-width:0 7px 7px;\n  border-style:solid;\n  border-color:transparent transparent #333;/*透明 透明  灰*/\n  position:relative;\n  z-index: 9;\n}\n.triangle[data-v-31af7fc5]::after {\n  content: '';\n  margin-left: -6px;\n  display: block;\n  width:0;\n  height:0;\n  border-style:solid;\n  border-width:0 6.5px 6.5px;\n  border-color:transparent transparent white;\n}\n.input-list>ul[data-v-31af7fc5] {\n  width: 100%;\n  display: inline-block;\n}\n.has-arrow[data-v-31af7fc5], .has-not-arrow[data-v-31af7fc5] {\n  font-size: 14px;\n  padding: 8px 20px;\n  position: relative;\n  white-space: nowrap;\n  overflow: hidden;\n  text-overflow: ellipsis;\n  color: #606266;\n  height: 34px;\n  line-height: 1.5;\n  -webkit-box-sizing: border-box;\n          box-sizing: border-box;\n  cursor: pointer;\n  outline: 0;\n}\n.has-arrow[data-v-31af7fc5]:after {\n  content: '>';\n  float: right;\n  color: #666666;\n}\n.has-not-arrow[data-v-31af7fc5]:after {\n  content: '>';\n  float: right;\n  color: transparent;\n}\n\n",""])},"59X9":function(t,n,e){"use strict";function a(t){e("GrZK")}Object.defineProperty(n,"__esModule",{value:!0});var i=e("bOdI"),s=e.n(i),o=e("lcoF"),l=e("mtWM"),r=e.n(l),c=e("nSkA"),h=e("x1ym"),d={mixins:[o.a],data:function(){var t,n=h.a.required(),e=(h.a.number(),h.a.string());return t={defaultOpen:[],params:this.$route.query,dataState:!1,rules:{uri:[n],enable:[n],metaTitle:[n],name:[n],path:[n,e]},fieldRequied:[{required:!0,validator:function(t,n,e){/^\s*$/g.test(n)?e(new Error("此项必填")):e()},message:"此项必填",trigger:"change"}],channelInfo:{},channelList:[{hasChild:!0,id:"",name:"根栏目"}],itemList:[],modelList:[],tplList:[],groupList:[],tplAll:[],modelIds:[]},s()(t,"channelInfo",{parentId:"",name:"",enable:!0,metaTitle:"",metaKeyword:"",metaDesc:"",txt:""}),s()(t,"tplContentVisbile",!1),s()(t,"ue",[]),s()(t,"showInputList",!1),s()(t,"selectedChannel",null),s()(t,"showChildList",!1),s()(t,"childrenList",[]),s()(t,"showGrandList",!1),s()(t,"grandList",[]),s()(t,"chosenList",[]),s()(t,"finalChannelId",null),s()(t,"chosenSubChannelList",[]),s()(t,"chosenSubChannelArray",[]),s()(t,"currentLevel",""),s()(t,"channelShowList","根目录"),s()(t,"pidArr",[]),t},methods:{reset:function(){this.channelInfo.metaDesc="",this.channelInfo.metaKeyword="",this.channelInfo.name="",this.channelInfo.enable="",this.channelInfo.metaTitle=!1},back:function(){this.routerLink("/channel/list","list",this.params.parentId)},addChannel:function(t){var n={parentId:this.params.id,modelId:t};this.routerLink("/channel/save","save",0,n)},getChannelId:function(t,n){n.isLeaf?(location.reload(),this.routerLink("/channel/update","update",t.id)):-1==t.id?this.routerLink("/channel/list"):(this.breadState=!0,this.routerLink("/channel/list","",t.id))},getFieldImg:function(t,n,e,a){this.info[n]=t},getMediaPath:function(t,n){this.info[n]=t},getPath:function(t){var n=this;r.a.post(this.$api.channelCreatPath,{name:t.target.value}).then(function(t){n.info.path=t.body})},getUeditor:function(t,n){this.ue[n]=t},getTitleImg:function(t){this.info.titleImg=t},getContentImg:function(t){this.info.contentImg=t},getChannelInfo:function(t){var n=this,e=this.$api.channelInfo+"/"+t;c.a.get(e).then(function(t){n.channelInfo=t.data.data,n.loading=!1}).catch(function(t){console.log(t)})},getDataInfo:function(){var t=this;this.loading=!0;var n={modelId:this.params.modelId,isChannel:!0};r.a.post(this.$api.itemList,n).then(function(n){t.$refs.form.resetFields();var e=n.body;for(var a in e)e[a].custom?(e[a].dataType,t.$set(t.info,"attr_"+e[a].field,t.channelInfo["attr_"+e[a].field])):(e[a].dataType,t.$set(t.info,e[a].field,t.channelInfo[e[a].field]));t.loading=!1,t.itemList=e,t.getDefaultInfo()}).catch(function(n){t.loading=!1})},getDefaultInfo:function(){var t=this,n=this.$api;this.$set(this.info,"modelId",this.channelInfo.modelId),this.$set(this.info,"staticChannel",this.channelInfo.staticChannel),this.$set(this.info,"staticContent",this.channelInfo.staticContent),this.$set(this.info,"accessByDir",this.channelInfo.accessByDir),this.$set(this.info,"listChild",this.channelInfo.listChild),this.$set(this.info,"pageSize",this.channelInfo.pageSize),this.$set(this.info,"hasTitleImg",this.channelInfo.hasTitleImg),this.$set(this.info,"hasContentImg",this.channelInfo.hasContentImg),this.$set(this.info,"blank",this.channelInfo.blank),""!=this.params.parentId?r.a.post(n.channelGet,{id:this.params.parentId}).then(function(n){t.info.parentId=n.body.nodeIds}):this.info.parentId=[""],this.dataState=!0},getAllList:function(){var t=this,n=this.$api;r.a.all([r.a.post(n.fullTextSearchChannelList,{hasContentOnly:!1,excludeId:this.params.id}),r.a.post(n.modelList,{containDisabled:!1}),r.a.post(n.tplModelList,{modelId:this.params.modelId}),r.a.post(n.groupList),r.a.post(n.tplSelectContentModel)]).then(r.a.spread(function(n,e,a,i,s){t.channelList=t.channelList.concat(n.body),t.modelList=e.body,t.tplList=a.body,t.groupList=i.body,t.tplAll=s.body;for(var o in t.tplAll)t.info.modelIds.push(t.channelInfo.models[o].id),t.info.tpls.push(t.channelInfo.tpls[o]),t.info.mtpls.push(t.channelInfo.mtpls[o])})).catch(function(n){t.loading=!1})},getEditorContent:function(){this.channelInfo.txt},getParams:function(){var t={};for(var n in this.channelInfo)t[n]=this.channelInfo[n];for(var e in t)t[e]instanceof Array&&(t[e]=t[e].join(","));return t},update:function(){var t=this,n=this.$refs.form;console.log(n),n.validate(function(n){if(!n)return!1;t.loading=!1;var e=t.getParams(),a=localStorage.getItem("chosenId");-1==a&&(a=null),e.parentId=a;var i=e.id,s=t.$api.channelUpdate;c.a.put(s+"/"+i,e).then(function(n){"0"==n.data.errorCode&&(t.successMessage("添加成功"),setTimeout(function(){t.back()},1e3))})})},getLastChannelName:function(t){var n=this;this.pidArr.push(t);var e=this.$api.channelInfo;c.a.get(e+"/"+t).then(function(t){var a=t.data.data;null==a.parentId?n.getChannelName(n.pidArr):c.a.get(e+"/"+a.parentId).then(function(t){var e=t.data.data;n.getLastChannelName(e.id)}).catch(function(t){console.log(t)})}).catch(function(t){return t})},getChannelName:function(t){var n=this,e=t.reverse();e.pop();var a=this.$api.channelInfo;for(var i in e)c.a.get(a+"/"+e[i]).then(function(t){var e=t.data.data;n.channelShowList=n.channelShowList+"/"+e.name}).catch(function(t){console.log(t)})},toggleShow:function(){0==this.showInputList?this.showInputList=!0:this.showInputList=!1}},created:function(){this.$store.dispatch("setCollapse",!0),this.loading=!0;var t=parseInt(this.params.id);this.getChannelInfo(t),this.getLastChannelName(t);var n=window.localStorage.getItem("currentChannel");this.defaultOpen.push(n)}},f=function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("section",{staticClass:"cms-body flex"},[e("a",{staticClass:"cms-back",attrs:{href:"javascript:void(0)"},on:{click:t.back}}),t._v(" "),e("cms-tree",{attrs:{treeType:"page",copy:!0,test:t.defaultOpen},on:{click:t.getChannelId}}),t._v(" "),e("div",{staticClass:"cms-content-right"},[e("router-link",{attrs:{to:"/channel/save"}},[e("el-button",{attrs:{type:"primary"}},[e("i",{directives:[{name:"perms",rawName:"v-perms",value:"/channel/save",expression:"'/channel/save'"}],staticClass:"el-icon-plus"}),t._v("栏目添加   \r\n                  ")])],1),t._v(" "),e("el-form",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"form",staticClass:"cms-form",staticStyle:{margin:"0",padding:"0"},attrs:{model:t.channelInfo,rules:t.rules,"label-width":"162px"}},[e("el-form-item",{staticClass:"flex-50",attrs:{label:"上级栏目",prop:"parentId"}},[e("el-input",{staticClass:"cms-width",attrs:{disabled:!0,value:t.channelShowList},on:{focus:t.toggleShow}})],1),t._v(" "),e("el-form-item",{staticClass:"flex-50",attrs:{label:"栏目名称",prop:"name"}},[e("el-input",{staticClass:"cms-width",model:{value:t.channelInfo.name,callback:function(n){t.$set(t.channelInfo,"name",n)},expression:"channelInfo.name"}})],1),t._v(" "),e("el-form-item",{staticClass:"flex-50",attrs:{label:"访问路径",prop:"uri"}},[e("el-input",{staticClass:"cms-width",attrs:{disabled:!0},model:{value:t.channelInfo.uri,callback:function(n){t.$set(t.channelInfo,"uri",n)},expression:"channelInfo.uri"}})],1),t._v(" "),e("el-form-item",{staticClass:"flex-50",attrs:{label:"是否可用",prop:"enable"}},[e("el-radio",{attrs:{label:!0},model:{value:t.channelInfo.enable,callback:function(n){t.$set(t.channelInfo,"enable",n)},expression:"channelInfo.enable"}},[t._v("是")]),t._v(" "),e("el-radio",{attrs:{label:!1},model:{value:t.channelInfo.enable,callback:function(n){t.$set(t.channelInfo,"enable",n)},expression:"channelInfo.enable"}},[t._v("否")])],1),t._v(" "),e("el-form-item",{staticClass:"flex-50",attrs:{label:"meta标题",prop:"metaTitle"}},[e("el-input",{staticClass:"cms-width",model:{value:t.channelInfo.metaTitle,callback:function(n){t.$set(t.channelInfo,"metaTitle",n)},expression:"channelInfo.metaTitle"}})],1),t._v(" "),e("el-form-item",{staticClass:"flex-50",attrs:{label:"meta关键字",prop:"metaKeyword"}},[e("el-input",{staticClass:"cms-width",model:{value:t.channelInfo.metaKeyword,callback:function(n){t.$set(t.channelInfo,"metaKeyword",n)},expression:"channelInfo.metaKeyword"}})],1),t._v(" "),e("el-form-item",{staticClass:"flex-100",attrs:{label:"meta描述",prop:"metaDesc"}},[e("el-input",{staticClass:"cms-width",attrs:{type:"textarea"},model:{value:t.channelInfo.metaDesc,callback:function(n){t.$set(t.channelInfo,"metaDesc",n)},expression:"channelInfo.metaDesc"}})],1),t._v(" "),e("div",{staticClass:"form-footer"},[e("el-button",{directives:[{name:"perms",rawName:"v-perms",value:"/channel/update",expression:"'/channel/update'"}],attrs:{type:"primary"},on:{click:function(n){t.update()}}},[t._v("修改")]),t._v(" "),e("el-button",{attrs:{type:"info"},on:{click:t.reset}},[t._v("重置")])],1)],1)],1)],1)},p=[],u={render:f,staticRenderFns:p},m=u,I=e("VU/8"),g=a,v=I(d,m,!1,g,"data-v-31af7fc5",null);n.default=v.exports},GrZK:function(t,n,e){var a=e("2swh");"string"==typeof a&&(a=[[t.i,a,""]]),a.locals&&(t.exports=a.locals);e("rjj0")("77886056",a,!0,{})}});