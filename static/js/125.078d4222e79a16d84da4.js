webpackJsonp([125],{RLqS:function(t,e,i){"use strict";function o(t){i("ofO+")}Object.defineProperty(e,"__esModule",{value:!0});var n=i("5HJ5"),l=(i("mtWM"),i("nSkA")),r={mixins:[n.a],data:function(){return{tableData:[],deleteGroup:[],enableButton:!1,tableTotal:null,queryEvents:{page:1,pageSize:10,private:null},currentSiteId:null,input5:"",select:"",showHttp:!0,eventForm:{id:null,img:null,title:null,thirdId:null,enable:1,thirdUrl:null,type:4,siteId:null,icon:null,spId:null,protocalType:null},formLabelWidth:"120px",dialogFormVisible:!1,formTitle:null,currentMode:null,showImage:!0}},methods:{selectProtocal:function(t){var e=this;switch(this.showHttp=!1,t){case 1:case"1":this.eventForm.protocalType="http";break;case 2:case"2":this.eventForm.protocalType="https"}setTimeout(function(){e.showHttp=!0},100)},searchByPrivate:function(t){0==t?(this.currentSiteId=this.eventForm.siteId,this.getEvents()):(this.currentSiteId=0,this.getEvents())},getEvents:function(){var t=this,e=this.$api.eventsList+"/"+this.currentSiteId+"?page="+this.queryEvents.page+"&pageSize="+this.queryEvents.pageSize;l.a.get(e).then(function(e){0==e.data.errorCode?(t.tableData=e.data.data.list,t.tableTotal=e.data.data.total):e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("操作失败")}).catch(function(t){console.log(t)})},handleClose:function(){this.getEvents()},addIntroduce:function(){this.resetForm(),this.dialogFormVisible=!0,this.currentMode="add",this.formTitle="新增活动推荐"},multiDelete:function(t){this.deleteGroup=t,t.length>0?this.enableButton=!0:this.enableButton=!1},toEdit:function(t){this.resetForm(),this.dialogFormVisible=!0,this.currentMode="update",this.formTitle="编辑活动推荐",this.eventForm=t,1==t.enable?t.enable=1:t.enable=0,-1==t.thirdUrl.indexOf("https")?-1==t.thirdUrl.indexOf("http")||(this.eventForm.protocalType="http",this.eventForm.thirdUrl=this.eventForm.thirdUrl.match(/http(\S*)/)[1].slice(3,this.eventForm.thirdUrl.length)):(this.eventForm.protocalType="https",this.eventForm.thirdUrl=this.eventForm.thirdUrl.match(/https(\S*)/)[1].slice(3,this.eventForm.thirdUrl.length))},toDelete:function(t){var e=this,i=t.id;this.$confirm("确定删除该项活动推荐?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.postDelete(i)}).catch(function(t){console.log(t)})},deleteMulti:function(){var t=this,e=[];for(var i in this.deleteGroup)e.push(this.deleteGroup[i].id);var o=e.join(",");this.$confirm("确定删除该项活动推荐?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.postDelete(o)}).catch(function(t){console.log(t)})},getPages:function(t,e){this.queryEvents.pageSize=e,this.queryEvents.page=t,this.getEvents()},getUrl:function(t,e,i,o){this.eventForm.img=t},getIcon:function(t,e,i,o){this.eventForm.icon=t},sureAdd:function(){-1==this.eventForm.thirdUrl.indexOf("https")&&-1==this.eventForm.thirdUrl.indexOf("http")&&(this.eventForm.thirdUrl=this.eventForm.protocalType+"://"+this.eventForm.thirdUrl),this.postAdd(this.eventForm)},sureUpdate:function(){-1==this.eventForm.thirdUrl.indexOf("https")&&-1==this.eventForm.thirdUrl.indexOf("http")&&(this.eventForm.thirdUrl=this.eventForm.protocalType+"://"+this.eventForm.thirdUrl),this.postAdd(this.eventForm)},resetForm:function(){var t=this;for(var e in this.eventForm)this.eventForm[e]=null;this.showImage=!1,this.eventForm.type=4,this.eventForm.enable=1,this.eventForm.siteId=this.currentSiteId,setTimeout(function(){t.showImage=!0},100)},postAdd:function(t){var e=this,i=this.$api.eventsSave;l.a.post(i,t).then(function(t){0==t.data.errorCode?(e.successMessage("操作成功"),e.dialogFormVisible=!1,e.getEvents()):t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("操作失败")}).catch(function(t){console.log(t)})},postDelete:function(t){var e=this,i=this.$api.eventsDelete+"/"+t;l.a.delete(i).then(function(t){0==t.data.errorCode?(e.successMessage("操作成功"),e.getEvents()):t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("操作失败")}).catch(function(t){console.log(t)})}},mounted:function(){var t=document.body.clientHeight;$(".cms-body").css("minHeight",t-110+"px"),this.$store.dispatch("setCollapse",!0)},created:function(){var t=window.localStorage.getItem("_site_id_param");this.currentSiteId=t,this.eventForm.siteId=t,this.getEvents()}},a=function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("section",{staticClass:"cms-body"},[i("div",{staticStyle:{"margin-top":"20px","margin-bottom":"20px","margin-right":"20px","margin-left":"20px"}},[i("el-button",{attrs:{type:"success"},on:{click:t.addIntroduce}},[t._v("新增活动推荐")]),t._v(" "),i("el-switch",{attrs:{"active-text":"公有","inactive-text":"私有"},on:{change:t.searchByPrivate},model:{value:t.queryEvents.private,callback:function(e){t.$set(t.queryEvents,"private",e)},expression:"queryEvents.private"}})],1),t._v(" "),i("el-table",{attrs:{data:t.tableData},on:{"selection-change":t.multiDelete}},[i("el-table-column",{attrs:{type:"selection",width:"65",align:"center"}}),t._v(" "),i("el-table-column",{attrs:{prop:"id",label:"ID",align:"center",width:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"title",label:"标题",align:"center",width:"200"}}),t._v(" "),i("el-table-column",{attrs:{prop:"img",label:"封面图",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(t){return i("div",{},[null!=t.row.img&&void 0!=t.row.img?i("img",{attrs:{src:t.row.img,alt:"",height:"100",width:"auto"}}):i("img",{attrs:{src:"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1540800848352&di=53c3301bb98d9cbaf75e6ed04e2e6d6a&imgtype=0&src=http%3A%2F%2F58pic.ooopic.com%2F58pic%2F14%2F70%2F68%2F34858PIC6sf_1024.jpg",height:"100",width:"auto"}})])}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"icon",label:"角标",align:"center",width:"200"},scopedSlots:t._u([{key:"default",fn:function(t){return i("div",{},[null!=t.row.icon&&void 0!=t.row.icon?i("img",{attrs:{src:t.row.icon,alt:"",height:"100",width:"auto"}}):i("img",{attrs:{src:"https://timgsa.baidu.com/timg?image&quality=80&size=b9999_10000&sec=1540800848352&di=53c3301bb98d9cbaf75e6ed04e2e6d6a&imgtype=0&src=http%3A%2F%2F58pic.ooopic.com%2F58pic%2F14%2F70%2F68%2F34858PIC6sf_1024.jpg",height:"100",width:"auto"}})])}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"spId",label:"spId",align:"center",width:"200"}}),t._v(" "),i("el-table-column",{attrs:{prop:"thirdUrl",label:"外链路径",align:"center",width:""}}),t._v(" "),i("el-table-column",{attrs:{prop:"enable",label:"可用",align:"center",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},[1==e.row.enable?i("span",[t._v("可用")]):t._e(),t._v(" "),0==e.row.enable?i("span",[t._v("禁用")]):t._e()])}}])}),t._v(" "),i("el-table-column",{attrs:{label:"操作",align:"center",width:""},scopedSlots:t._u([{key:"default",fn:function(e){return i("div",{},[i("cms-button",{attrs:{type:"edit"},on:{click:function(i){t.toEdit(e.row)}}}),t._v(" "),i("cms-button",{attrs:{type:"delete"},on:{click:function(i){t.toDelete(e.row)}}})],1)}}])})],1),t._v(" "),i("div",{staticClass:"cms-list-footer",staticStyle:{"padding-bottom":"100px"}},[t.enableButton?i("el-button",{attrs:{type:"info"},on:{click:t.deleteMulti}},[t._v("批量删除")]):i("el-button",{attrs:{type:"info",disabled:""}},[t._v("批量删除")]),t._v(" "),i("cms-pagination",{attrs:{total:t.tableTotal,pageSize:t.queryEvents.pageSize,page:t.queryEvents.page,init:!0},on:{change:t.getPages}})],1),t._v(" "),i("el-dialog",{attrs:{title:t.formTitle,visible:t.dialogFormVisible},on:{"update:visible":function(e){t.dialogFormVisible=e},close:t.handleClose}},[i("el-form",{staticClass:"cms-form",model:{value:t.eventForm,callback:function(e){t.eventForm=e},expression:"eventForm"}},[i("el-form-item",{staticClass:"flex-50",attrs:{"label-width":t.formLabelWidth,label:"标题"}},[i("el-input",{model:{value:t.eventForm.title,callback:function(e){t.$set(t.eventForm,"title",e)},expression:"eventForm.title"}})],1),t._v(" "),i("el-form-item",{staticClass:"flex-50",attrs:{"label-width":t.formLabelWidth,label:"spId"}},[i("el-input",{attrs:{type:"number"},model:{value:t.eventForm.spId,callback:function(e){t.$set(t.eventForm,"spId",e)},expression:"eventForm.spId"}})],1),t._v(" "),i("el-form-item",{staticClass:"flex-100",attrs:{"label-width":t.formLabelWidth,label:"外链路径"}},[t.showHttp?i("el-input",{staticClass:"input-with-select",attrs:{placeholder:"请输入内容"},model:{value:t.eventForm.thirdUrl,callback:function(e){t.$set(t.eventForm,"thirdUrl",e)},expression:"eventForm.thirdUrl"}},[i("el-select",{attrs:{slot:"prepend",placeholder:"请选择"},on:{change:t.selectProtocal},slot:"prepend",model:{value:t.eventForm.protocalType,callback:function(e){t.$set(t.eventForm,"protocalType",e)},expression:"eventForm.protocalType"}},[i("el-option",{attrs:{label:"http",value:"1"}}),t._v(" "),i("el-option",{attrs:{label:"https",value:"2"}})],1)],1):t._e()],1),t._v(" "),i("el-form-item",{staticClass:"flex-50",attrs:{"label-width":t.formLabelWidth,label:"封面图"}},[t.showImage?i("uploader",{attrs:{default:t.eventForm.img},on:{change:t.getUrl}}):t._e()],1),t._v(" "),i("el-form-item",{staticClass:"flex-50",attrs:{"label-width":t.formLabelWidth,label:"角标"}},[t.showImage?i("uploader",{attrs:{default:t.eventForm.icon},on:{change:t.getIcon}}):t._e()],1),t._v(" "),i("el-form-item",{staticClass:"flex-50",attrs:{"label-width":t.formLabelWidth,label:"可用"}},[i("el-radio-group",{model:{value:t.eventForm.enable,callback:function(e){t.$set(t.eventForm,"enable",e)},expression:"eventForm.enable"}},[i("el-radio",{attrs:{label:1}},[t._v("是")]),t._v(" "),i("el-radio",{attrs:{label:0}},[t._v("否")])],1)],1)],1),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogFormVisible=!1}}},[t._v("取 消")]),t._v(" "),"add"==t.currentMode?i("el-button",{attrs:{type:"primary"},on:{click:t.sureAdd}},[t._v("确 定")]):t._e(),t._v(" "),"update"==t.currentMode?i("el-button",{attrs:{type:"warning"},on:{click:t.sureUpdate}},[t._v("更 新")]):t._e()],1)],1)],1)},s=[],c={render:a,staticRenderFns:s},d=c,h=i("VU/8"),u=o,p=h(r,d,!1,u,null,null);e.default=p.exports},bbQX:function(t,e,i){e=t.exports=i("FZ+f")(!1),e.push([t.i,"\n.el-dialog {\n  margin-top: 100px !important;\n  width: 80%;\n}\n.el-select .el-input {\n  width: 130px;\n}\n.input-with-select .el-input-group__prepend {\n  background-color: #fff;\n}\n",""])},"ofO+":function(t,e,i){var o=i("bbQX");"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i("rjj0")("2e17c545",o,!0,{})}});