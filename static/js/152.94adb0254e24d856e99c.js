webpackJsonp([152],{N6ou:function(e,t,a){var l=a("RjKo");"string"==typeof l&&(l=[[e.i,l,""]]),l.locals&&(e.exports=l.locals);a("rjj0")("8c86e1b6",l,!0,{})},RjKo:function(e,t,a){t=e.exports=a("FZ+f")(!1),t.push([e.i,"",""])},qg8y:function(e,t,a){"use strict";function l(e){a("N6ou")}Object.defineProperty(t,"__esModule",{value:!0});var o=a("5HJ5"),r=(a("mtWM"),a("nSkA")),i={mixins:[o.a],data:function(){return{currentSiteId:null,tableData:[],tableTotal:null,queryTemplate:{page:1,pageSize:10,private:null},templateForm:{id:null,blockName:null,blockType:null,showName:null,sort:null,enable:1,type:1,siteId:null},formLabelWidth:"120px",dialogFormVisible:!1,formTitle:null,currentMode:null,deleteGroup:[],enableButton:!1}},methods:{clearStorage:function(){var e=this;r.a.get(this.$api.contentStorage+"/"+this.currentSiteId).then(function(t){0==t.data.errorCode?1==t.data.data?e.successMessage("缓存清理成功"):e.errorMessage("操作失败"):t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("操作失败")}).catch(function(e){console.log(e)})},searchByPrivate:function(e){0==e?(this.currentSiteId=this.queryTemplate.siteId,this.getTemplates()):(this.currentSiteId=0,this.getTemplates())},addBlock:function(){this.resetForm(),this.dialogFormVisible=!0,this.currentMode="add",this.formTitle="新增详情页区块"},getTemplates:function(){var e=this,t=this.$api.templatesList+"/"+this.currentSiteId+"?page="+this.queryTemplate.page+"&pageSize="+this.queryTemplate.pageSize;r.a.get(t).then(function(t){0==t.data.errorCode?(e.tableData=t.data.data.list,e.tableTotal=t.data.data.total):t.data.errorMessage?e.errorMessage(t.data.errorMessage):e.errorMessage("操作失败")}).catch(function(e){console.log(e)})},getPages:function(e,t){this.queryTemplate.page=e,this.queryTemplate.pageSize=t,this.getTemplates()},toEdit:function(e){this.dialogFormVisible=!0,this.currentMode="update",this.formTitle="编辑详情页区块",this.templateForm=e,1==e.enable?e.enable=1:e.enable=0},checkSort:function(){return Object(r.f)(this.templateForm.sort)||null==this.templateForm.sort||void 0==this.templateForm.sort?(this.errorMessage("请输入合法数值"),!1):this.templateForm.sort<0?(this.errorMessage("请输入合法数值"),!1):void 0},resetForm:function(){for(var e in this.templateForm)this.templateForm[e]=null;this.templateForm.type=1,this.templateForm.enable=1,this.templateForm.siteId=this.currentSiteId},sureAdd:function(){switch(this.templateForm.blockType){case 1:case"1":this.templateForm.blockName="商品";break;case 2:case"2":this.templateForm.blockName="片花咨询";break;case 3:case"3":this.templateForm.blockName="活动推荐";break;case 4:case"4":this.templateForm.blockName="相关内容";break;case 5:case"5":this.templateForm.blockName="内容详情";break;default:this.templateForm.blockName=null}this.postAdd(this.templateForm)},sureUpdate:function(){this.postAdd(this.templateForm)},postAdd:function(e){var t=this,a=this.$api.templatesSave;r.a.post(a,e).then(function(e){0==e.data.errorCode?(t.successMessage("操作成功"),t.dialogFormVisible=!1,t.getTemplates()):e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("操作失败")}).catch(function(e){console.log(e)})},toDelete:function(e){var t=this,a=e.id;this.$confirm("确定删除该项区块模板?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.postDelete(a)}).catch(function(e){console.log(e)})},postDelete:function(e){var t=this,a=this.$api.templatesDelete+"/"+e;r.a.delete(a).then(function(e){0==e.data.errorCode?(t.successMessage("操作成功"),t.getTemplates()):e.data.errorMessage?t.errorMessage(e.data.errorMessage):t.errorMessage("操作失败")}).catch(function(e){console.log(e)})},multiDelete:function(e){this.deleteGroup=e,e.length>0?this.enableButton=!0:this.enableButton=!1},deleteMulti:function(){var e=this,t=[];for(var a in this.deleteGroup)t.push(this.deleteGroup[a].id);var l=t.join(",");this.$confirm("确定删除该项区块模板?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.postDelete(l)}).catch(function(e){console.log(e)})}},mounted:function(){var e=document.body.clientHeight;$(".cms-body").css("minHeight",e-110+"px"),this.$store.dispatch("setCollapse",!0)},created:function(){var e=window.localStorage.getItem("_site_id_param");this.currentSiteId=e,this.queryTemplate.siteId=e,this.getTemplates()}},s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("section",{staticClass:"cms-body"},[a("div",{staticStyle:{"margin-top":"20px","margin-bottom":"20px","margin-right":"20px","margin-left":"20px"}},[a("el-button",{attrs:{type:"success"},on:{click:e.addBlock}},[e._v("新增详情页区块")]),e._v(" "),a("el-button",{attrs:{type:"danger"},on:{click:e.clearStorage}},[e._v("清理缓存")]),e._v(" "),a("el-switch",{attrs:{"active-text":"公有","inactive-text":"私有"},on:{change:e.searchByPrivate},model:{value:e.queryTemplate.private,callback:function(t){e.$set(e.queryTemplate,"private",t)},expression:"queryTemplate.private"}})],1),e._v(" "),a("el-table",{attrs:{data:e.tableData},on:{"selection-change":e.multiDelete}},[a("el-table-column",{attrs:{type:"selection",width:"65",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"id",label:"ID",align:"center",width:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"blockName",label:"区块名称",align:"center",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"showName",label:"展示名称",align:"center",width:"200"}}),e._v(" "),a("el-table-column",{attrs:{prop:"sort",label:"排序",align:"center",width:""}}),e._v(" "),a("el-table-column",{attrs:{prop:"enable",label:"可用",align:"center",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[1==t.row.enable?a("span",[e._v("可用")]):e._e(),e._v(" "),0==t.row.enable?a("span",[e._v("禁用")]):e._e()])}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"blockType",label:"区块类型",align:"center",width:""}}),e._v(" "),a("el-table-column",{attrs:{label:"操作",align:"center",width:""},scopedSlots:e._u([{key:"default",fn:function(t){return a("div",{},[a("cms-button",{attrs:{type:"edit"},on:{click:function(a){e.toEdit(t.row)}}}),e._v(" "),a("cms-button",{attrs:{type:"delete"},on:{click:function(a){e.toDelete(t.row)}}})],1)}}])})],1),e._v(" "),a("div",{staticClass:"cms-list-footer",staticStyle:{"padding-bottom":"100px"}},[e.enableButton?a("el-button",{attrs:{type:"info"},on:{click:e.deleteMulti}},[e._v("批量删除")]):a("el-button",{attrs:{type:"info",disabled:""}},[e._v("批量删除")]),e._v(" "),a("cms-pagination",{attrs:{total:e.tableTotal,pageSize:e.queryTemplate.pageSize,page:e.queryTemplate.page,init:!0},on:{change:e.getPages}})],1),e._v(" "),a("el-dialog",{attrs:{title:e.formTitle,visible:e.dialogFormVisible},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{model:{value:e.templateForm,callback:function(t){e.templateForm=t},expression:"templateForm"}},[a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"区块名称"}},[a("el-radio-group",{model:{value:e.templateForm.blockType,callback:function(t){e.$set(e.templateForm,"blockType",t)},expression:"templateForm.blockType"}},[a("el-radio",{attrs:{label:1}},[e._v("商品")]),e._v(" "),a("el-radio",{attrs:{label:2}},[e._v("片花咨询")]),e._v(" "),a("el-radio",{attrs:{label:3}},[e._v("活动推荐")]),e._v(" "),a("el-radio",{attrs:{label:4}},[e._v("相关内容")]),e._v(" "),a("el-radio",{attrs:{label:5}},[e._v("内容详情")])],1)],1),e._v(" "),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"展示名称"}},[a("el-input",{model:{value:e.templateForm.showName,callback:function(t){e.$set(e.templateForm,"showName",t)},expression:"templateForm.showName"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"排序"}},[a("el-input",{attrs:{type:"number"},on:{blur:e.checkSort},model:{value:e.templateForm.sort,callback:function(t){e.$set(e.templateForm,"sort",t)},expression:"templateForm.sort"}})],1),e._v(" "),a("el-form-item",{attrs:{"label-width":e.formLabelWidth,label:"可用"}},[a("el-radio-group",{model:{value:e.templateForm.enable,callback:function(t){e.$set(e.templateForm,"enable",t)},expression:"templateForm.enable"}},[a("el-radio",{attrs:{label:1}},[e._v("是")]),e._v(" "),a("el-radio",{attrs:{label:0}},[e._v("否")])],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogFormVisible=!1}}},[e._v("取 消")]),e._v(" "),"add"==e.currentMode?a("el-button",{attrs:{type:"primary"},on:{click:e.sureAdd}},[e._v("确 定")]):e._e(),e._v(" "),"update"==e.currentMode?a("el-button",{attrs:{type:"warning"},on:{click:e.sureUpdate}},[e._v("更 新")]):e._e()],1)],1)],1)},n=[],c={render:s,staticRenderFns:n},m=c,u=a("VU/8"),p=l,d=u(i,m,!1,p,null,null);t.default=d.exports}});